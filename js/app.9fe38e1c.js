(function(){"use strict";var t={8693:function(t,i,s){var e=s(6369),n=function(){var t=this,i=t._self._c;return i("div",{attrs:{id:"app"}},[i("mumuGetQrcode",{attrs:{continue:!0,exact:"environment",definition:!0},on:{success:t.qrcodeSucess}})],1)},a=[],o=function(){var t=this,i=t._self._c;return i("div",{staticClass:"canvasBox"},[t.isUse?[t._m(0),t.isUseTorch?i("div",{staticClass:"box2"},[i("div",{staticClass:"track",on:{click:t.openTrack}},[i("svg",{staticClass:"icon",attrs:{t:"1653920715959",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"1351",width:"32",height:"32"}},[i("path",{attrs:{d:"M651.353043 550.479503H378.752795L240.862609 364.315031c-3.688944-4.897391-5.660621-10.876025-5.660621-17.045466v-60.040745c0-15.773416 12.847702-28.621118 28.621118-28.621118h502.459627c15.773416 0 28.621118 12.847702 28.621118 28.621118v59.977143c0 6.105839-1.971677 12.084472-5.660621 17.045466l-137.890187 186.228074zM378.752795 598.308571v398.024348c0 15.328199 12.402484 27.667081 27.667081 27.667081h217.266087c15.328199 0 27.667081-12.402484 27.66708-27.667081V598.308571H378.752795z m136.300124 176.942112c-14.564969 0-26.331429-11.76646-26.331428-26.331428v-81.283975c0-14.564969 11.76646-26.331429 26.331428-26.331429 14.564969 0 26.331429 11.76646 26.331429 26.331429v81.283975c0 14.564969-11.76646 26.331429-26.331429 26.331428zM512 222.608696c-17.554286 0-31.801242-14.246957-31.801242-31.801243V31.801242c0-17.554286 14.246957-31.801242 31.801242-31.801242s31.801242 14.246957 31.801242 31.801242v159.006211c0 17.554286-14.246957 31.801242-31.801242 31.801243zM280.932174 205.881242c-9.47677 0-18.889938-4.197764-25.122981-12.275279L158.242981 67.991056a31.864845 31.864845 0 0 1 5.597019-44.648944 31.864845 31.864845 0 0 1 44.648944 5.597018l97.502609 125.551305a31.864845 31.864845 0 0 1-5.597019 44.648944c-5.787826 4.579379-12.656894 6.741863-19.46236 6.741863zM723.987081 205.881242c-6.805466 0-13.674534-2.162484-19.462361-6.678261a31.794882 31.794882 0 0 1-5.597018-44.648944l97.566211-125.551304a31.794882 31.794882 0 0 1 44.648944-5.597019 31.794882 31.794882 0 0 1 5.597019 44.648944l-97.566211 125.551305c-6.360248 8.077516-15.709814 12.27528-25.186584 12.275279z",fill:"#ffffff","p-id":"1352"}})]),t._v(" "+t._s(t.trackStatus?"关闭闪光灯":"打开闪光灯")+" ")])]):t._e(),i("div",{staticClass:"mask1 mask",style:"height:"+t.maskHeight+"px;"}),i("div",{staticClass:"mask2 mask",style:"width:"+t.maskWidth+"px;top:"+t.maskHeight+"px;height:"+t.canvasHeight+"px"}),i("div",{staticClass:"mask3 mask",style:"height:"+t.maskHeight+"px;"}),i("div",{staticClass:"mask4 mask",style:"width:"+t.maskWidth+"px;top:"+t.maskHeight+"px;height:"+t.canvasHeight+"px"})]:t._e()],2)},h=[function(){var t=this,i=t._self._c;return i("div",{staticClass:"box"},[i("div",{staticClass:"line"}),i("div",{staticClass:"angle"})])}],c=s(851),r=s.n(c),d={props:{continue:{type:Boolean,default:!1},exact:{type:String,default:"environment"},size:{type:String,default:"whole"},definition:{type:Boolean,default:!1}},data(){return{windowWidth:0,windowHeight:0,video:null,canvas2d:null,canvas2d2:null,canvasWidth:200,canvasHeight:200,maskWidth:0,maskHeight:0,inter:0,track:null,isUseTorch:!1,trackStatus:!1,isParse:!1,isUse:!0}},mounted(){if(-1===origin.indexOf("https"))return console.log("请在 https 环境中使用摄像头组件。"),!1;this.windowWidth=document.documentElement.clientWidth||document.body.clientWidth,this.windowHeight=document.documentElement.clientHeight||document.body.clientHeight,this.windowHeight="whole"===this.size?this.windowHeight:this.windowHeight/2,this.isParse=!0,this.$nextTick((()=>{this.createMsk(),this.openScan()}))},destroyed(){this.closeCamera()},methods:{openScan(){const t=this.transtion(this.windowHeight),i=this.transtion(this.windowWidth),s={audio:!1,video:{facingMode:{exact:this.exact},width:t,height:i}};try{navigator.mediaDevices.getUserMedia(s).then((t=>{this.video=document.createElement("video"),this.video.width=this.windowWidth,this.video.height=this.windowHeight;const i=document.createElement("canvas");i.id="canvas",i.width=this.transtion(this.canvasWidth),i.height=this.transtion(this.canvasHeight),i.style="display:none;",this.canvas2d=i.getContext("2d");const s=document.querySelector(".canvasBox");s.append(this.video),s.append(i),s.style=`width:${this.windowWidth}px;height:${this.windowHeight}px;`;const e=document.createElement("canvas");e.id="canvas2",e.width=this.canvasWidth,e.height=this.canvasHeight,e.style="position: absolute;top: 50%;left: 50%;z-index: 20;transform: translate(-50%, -50%);",this.canvas2d2=e.getContext("2d"),s.append(e),this.video.srcObject=t,this.video.setAttribute("playsinline",!0),this.video.play(),this.tick(),this.track=t.getVideoTracks()[0],setTimeout((()=>{this.isUseTorch=this.track.getCapabilities().torch||null}),500)})).catch((function(t){console.log("Error accessing camera: "+t)}))}catch(e){console.log(e)}},closeCamera(){this.isParse=!1,this.video&&this.video.srcObject&&this.video.srcObject.getTracks().forEach((t=>{t.stop()}))},tick(){if(this.isParse){if(this.video.readyState===this.video.HAVE_ENOUGH_DATA){this.canvas2d.drawImage(this.video,this.transtion(this.maskWidth),this.transtion(this.maskHeight),this.transtion(200),this.transtion(200),0,0,this.transtion(this.canvasWidth),this.transtion(this.canvasHeight));const t=this.canvas2d.getImageData(0,0,this.transtion(this.canvasWidth),this.transtion(this.canvasHeight)),i=r()(t.data,t.width,t.height,{inversionAttempts:"dontInvert"});this.canvas2d2.clearRect(0,0,this.canvasWidth,this.canvasHeight),i&&(this.drawLine(i.location.topLeftCorner,i.location.topRightCorner),this.drawLine(i.location.topRightCorner,i.location.bottomRightCorner),this.drawLine(i.location.bottomRightCorner,i.location.bottomLeftCorner),this.drawLine(i.location.bottomLeftCorner,i.location.topLeftCorner),i.data&&this.getData(i.data))}window.requestAnimationFrame(this.tick())}},drawLine(t,i,s="#FF3B58"){this.canvas2d2.beginPath(),this.canvas2d2.moveTo(this.nutranstion(t.x),this.nutranstion(t.y)),this.canvas2d2.lineTo(this.nutranstion(i.x),this.nutranstion(i.y)),this.canvas2d2.lineWidth=4,this.canvas2d2.strokeStyle=s,this.canvas2d2.stroke()},getData(t){this.$emit("success",t),this.continue||this.closeCamera()},openTrack(){this.trackStatus=!this.trackStatus,this.track.applyConstraints({advanced:[{torch:this.trackStatus}]})},createMsk(){this.maskWidth=this.windowWidth/2-this.canvasWidth/2,this.maskHeight=this.windowHeight/2-this.canvasHeight/2},transtion(t){return this.definition?2.8*t:1.8*t},nutranstion(t){return this.definition?t/2.8:t/1.8}}},l=d,u=s(1001),v=(0,u.Z)(l,o,h,!1,null,"e4c0be8a",null),g=v.exports,f={name:"App",components:{mumuGetQrcode:g},methods:{qrcodeSucess(t){console.log(t)},qrcodeError(t){console.log(t)}}},p=f,m=(0,u.Z)(p,n,a,!1,null,null,null),w=m.exports;e.ZP.config.productionTip=!1,new e.ZP({render:t=>t(w)}).$mount("#app")}},i={};function s(e){var n=i[e];if(void 0!==n)return n.exports;var a=i[e]={exports:{}};return t[e].call(a.exports,a,a.exports,s),a.exports}s.m=t,function(){var t=[];s.O=function(i,e,n,a){if(!e){var o=1/0;for(d=0;d<t.length;d++){e=t[d][0],n=t[d][1],a=t[d][2];for(var h=!0,c=0;c<e.length;c++)(!1&a||o>=a)&&Object.keys(s.O).every((function(t){return s.O[t](e[c])}))?e.splice(c--,1):(h=!1,a<o&&(o=a));if(h){t.splice(d--,1);var r=n();void 0!==r&&(i=r)}}return i}a=a||0;for(var d=t.length;d>0&&t[d-1][2]>a;d--)t[d]=t[d-1];t[d]=[e,n,a]}}(),function(){s.n=function(t){var i=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(i,{a:i}),i}}(),function(){s.d=function(t,i){for(var e in i)s.o(i,e)&&!s.o(t,e)&&Object.defineProperty(t,e,{enumerable:!0,get:i[e]})}}(),function(){s.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){s.o=function(t,i){return Object.prototype.hasOwnProperty.call(t,i)}}(),function(){var t={143:0};s.O.j=function(i){return 0===t[i]};var i=function(i,e){var n,a,o=e[0],h=e[1],c=e[2],r=0;if(o.some((function(i){return 0!==t[i]}))){for(n in h)s.o(h,n)&&(s.m[n]=h[n]);if(c)var d=c(s)}for(i&&i(e);r<o.length;r++)a=o[r],s.o(t,a)&&t[a]&&t[a][0](),t[a]=0;return s.O(d)},e=self["webpackChunkdemo"]=self["webpackChunkdemo"]||[];e.forEach(i.bind(null,0)),e.push=i.bind(null,e.push.bind(e))}();var e=s.O(void 0,[998],(function(){return s(8693)}));e=s.O(e)})();
//# sourceMappingURL=app.9fe38e1c.js.map